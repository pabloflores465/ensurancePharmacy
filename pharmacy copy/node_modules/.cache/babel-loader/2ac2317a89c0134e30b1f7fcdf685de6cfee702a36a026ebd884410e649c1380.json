{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport { ref, onMounted, computed } from 'vue';\nimport axios from 'axios';\nimport { useRouter } from 'vue-router';\nimport HospitalSelector from '../components/HospitalSelector.vue';\nexport default {\n  __name: 'Prescriptions',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const router = useRouter();\n    const recipes = ref([]);\n    const errorMessage = ref('');\n    const patientInfo = ref(null);\n    const selectedPort = ref(localStorage.getItem('selectedHospitalPort') || '');\n\n    // URL base computada usando las variables de entorno\n    const baseUrl = computed(() => {\n      const serverIp = process.env.VUE_APP_IP || '192.168.0.3';\n      const port = selectedPort.value || '5050';\n      return `http://${serverIp}:${port}/recipes/email/`;\n    });\n\n    // Manejar la selección del hospital\n    const onHospitalSelected = port => {\n      selectedPort.value = port;\n      fetchPrescriptions();\n    };\n\n    // Funciones auxiliares para extraer información del paciente\n    const getPatientName = recipe => {\n      // Si el paciente es un objeto completo en la receta\n      if (recipe.patient && typeof recipe.patient === 'object' && recipe.patient.username) {\n        return recipe.patient.username;\n      }\n      // Si el paciente está referenciado como ID y tenemos la información del paciente guardada\n      if (patientInfo.value && recipe.patient === patientInfo.value._id) {\n        return patientInfo.value.username;\n      }\n      // Si doctor_details está presente, usamos el formato doctor_details\n      if (recipe.doctor_details) {\n        return recipe.patient_details ? recipe.patient_details.username : 'Paciente';\n      }\n      return 'Paciente';\n    };\n    const getPatientEmail = recipe => {\n      // Si el paciente es un objeto completo en la receta\n      if (recipe.patient && typeof recipe.patient === 'object' && recipe.patient.email) {\n        return recipe.patient.email;\n      }\n      // Si el paciente está referenciado como ID y tenemos la información del paciente guardada\n      if (patientInfo.value && recipe.patient === patientInfo.value._id) {\n        return patientInfo.value.email;\n      }\n      // Si patient_details está presente\n      if (recipe.patient_details) {\n        return recipe.patient_details.email;\n      }\n      return '';\n    };\n    const getDiagnostic = recipe => {\n      // Intentar obtener diagnóstico desde diferentes estructuras posibles\n      if (recipe.diagnostic) {\n        return recipe.diagnostic;\n      }\n      if (recipe.medicines && recipe.medicines.length > 0 && recipe.medicines[0].diagnostico) {\n        return recipe.medicines[0].diagnostico;\n      }\n      return 'No especificado';\n    };\n\n    // Función para navegar a la página de verificación\n    function goToVerification(medicinePrincipioActivo, recipeId) {\n      if (!medicinePrincipioActivo) {\n        console.error('No se proporcionó Principio Activo para la verificación.');\n        errorMessage.value = 'Error interno: No se pudo seleccionar el medicamento.';\n        return;\n      }\n      console.log(`Navegando a VerificarCompra para Principio Activo: ${medicinePrincipioActivo}, receta ID: ${recipeId}`);\n      router.push({\n        name: 'VerificarCompra',\n        params: {\n          id: medicinePrincipioActivo\n        },\n        query: {\n          recipeId: recipeId\n        }\n      });\n    }\n    const fetchPrescriptions = async () => {\n      // Si no hay puerto seleccionado, no continuar\n      if (!selectedPort.value) {\n        console.log('Esperando selección de hospital...');\n        return;\n      }\n      try {\n        // Obtener el email del usuario del localStorage\n        let userEmail = ''; // Valor por defecto\n        try {\n          const userData = JSON.parse(localStorage.getItem('user'));\n          if (userData && userData.email) {\n            userEmail = userData.email;\n            console.log(\"Email de usuario obtenido:\", userEmail);\n          } else {\n            // Intentar obtener desde session\n            const sessionData = JSON.parse(localStorage.getItem('session'));\n            if (sessionData && sessionData.email) {\n              userEmail = sessionData.email;\n              console.log(\"Email de usuario obtenido de session:\", userEmail);\n            } else {\n              console.warn(\"No se encontró el email de usuario en localStorage\");\n              // Fallback a username si no hay email\n              if (userData && userData.name) {\n                userEmail = userData.name;\n                console.log(\"Usando nombre de usuario en lugar de email:\", userEmail);\n              } else if (sessionData && sessionData.name) {\n                userEmail = sessionData.name;\n                console.log(\"Usando nombre de usuario de session en lugar de email:\", userEmail);\n              } else {\n                userEmail = 'rrrivera@unis.edu.gt'; // Valor por defecto si no hay información\n              }\n            }\n          }\n        } catch (err) {\n          console.error(\"Error al obtener el usuario del localStorage:\", err);\n          userEmail = 'rrrivera@unis.edu.gt'; // Valor por defecto en caso de error\n        }\n\n        // Usando la URL dinámica con IP y puerto\n        const url = `${baseUrl.value}${userEmail}`;\n        console.log(`Consultando recetas con URL dinámica: ${url}`);\n        const response = await axios.get(url, {\n          headers: {\n            'Accept': 'application/json',\n            'Content-Type': 'application/json'\n          }\n        });\n        console.log(\"Respuesta recibida:\", response);\n\n        // Verificar si la respuesta es HTML (texto que comienza con <!DOCTYPE o <html)\n        if (typeof response.data === 'string' && (response.data.trim().startsWith('<!DOCTYPE') || response.data.trim().startsWith('<html'))) {\n          console.error(\"Se recibió HTML en lugar de JSON:\", response.data.substring(0, 200) + '...');\n          recipes.value = [];\n          errorMessage.value = 'El servidor respondió con HTML en lugar de datos JSON. Verifique la conexión.';\n          return;\n        }\n\n        // Manejo flexible de diferentes formatos de respuesta\n        if (response.data) {\n          let recetasEncontradas = false;\n\n          // Verificamos si existe el objeto patient (formato nuevo)\n          if (response.data.patient && Array.isArray(response.data.recipes)) {\n            recipes.value = response.data.recipes;\n            patientInfo.value = response.data.patient;\n            recetasEncontradas = true;\n            console.log(\"Formato 1: Objeto con patient y recipes array\");\n          }\n          // Verificamos si recipes existe directamente en la respuesta como array\n          else if (Array.isArray(response.data.recipes)) {\n            recipes.value = response.data.recipes;\n            recetasEncontradas = true;\n            console.log(\"Formato 2: Objeto con recipes array\");\n          }\n          // En caso de que la API devuelva un array directamente\n          else if (Array.isArray(response.data)) {\n            recipes.value = response.data;\n            recetasEncontradas = true;\n            console.log(\"Formato 3: Array directo\");\n          }\n          // Si la API devuelve un objeto que es la receta directamente\n          else if (response.data._id && response.data.medicines) {\n            recipes.value = [response.data];\n            recetasEncontradas = true;\n            console.log(\"Formato 4: Objeto de receta única\");\n          }\n          // Si no reconocemos el formato, pero hay un objeto receta\n          else if (typeof response.data === 'object') {\n            // Intentar extraer cualquier array que parezca contener recetas\n            const possibleRecipesArrays = Object.values(response.data).filter(val => Array.isArray(val) && val.length > 0 && val[0]._id && val[0].medicines);\n            if (possibleRecipesArrays.length > 0) {\n              recipes.value = possibleRecipesArrays[0];\n              recetasEncontradas = true;\n              console.log(\"Formato 5: Extraído array de recetas de objeto\", possibleRecipesArrays[0]);\n            } else {\n              // Último intento: buscar propiedades que parezcan recetas individuales\n              const possibleRecipes = Object.values(response.data).filter(val => val && typeof val === 'object' && val._id && val.medicines);\n              if (possibleRecipes.length > 0) {\n                recipes.value = possibleRecipes;\n                recetasEncontradas = true;\n                console.log(\"Formato 6: Extraídas recetas individuales\", possibleRecipes);\n              }\n            }\n          }\n          console.log(\"RECETAS PROCESADAS:\", recipes.value);\n          if (!recetasEncontradas) {\n            console.warn(\"Formato de respuesta no reconocido:\", response.data);\n            recipes.value = [];\n            errorMessage.value = 'Formato de respuesta no reconocido. Consulte la consola para más detalles.';\n          } else if (recipes.value.length === 0) {\n            errorMessage.value = 'No se encontraron recetas para este usuario.';\n          }\n        } else {\n          console.warn(\"La respuesta del API está vacía\");\n          recipes.value = [];\n          errorMessage.value = 'No se encontraron recetas para este usuario.';\n        }\n      } catch (error) {\n        console.error(\"Error al obtener las recetas:\", error);\n        recipes.value = [];\n        errorMessage.value = `Error al obtener las recetas: ${error.message}. Por favor, inténtelo de nuevo.`;\n      }\n    };\n    onMounted(() => {\n      // Solo cargar recetas si ya hay un puerto seleccionado\n      if (selectedPort.value) {\n        fetchPrescriptions();\n      }\n    });\n    const __returned__ = {\n      router,\n      recipes,\n      errorMessage,\n      patientInfo,\n      selectedPort,\n      baseUrl,\n      onHospitalSelected,\n      getPatientName,\n      getPatientEmail,\n      getDiagnostic,\n      goToVerification,\n      fetchPrescriptions,\n      ref,\n      onMounted,\n      computed,\n      get axios() {\n        return axios;\n      },\n      get useRouter() {\n        return useRouter;\n      },\n      HospitalSelector\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","onMounted","computed","axios","useRouter","HospitalSelector","router","recipes","errorMessage","patientInfo","selectedPort","localStorage","getItem","baseUrl","serverIp","process","env","VUE_APP_IP","port","value","onHospitalSelected","fetchPrescriptions","getPatientName","recipe","patient","username","_id","doctor_details","patient_details","getPatientEmail","email","getDiagnostic","diagnostic","medicines","length","diagnostico","goToVerification","medicinePrincipioActivo","recipeId","console","error","log","push","name","params","id","query","userEmail","userData","JSON","parse","sessionData","warn","err","url","response","get","headers","data","trim","startsWith","substring","recetasEncontradas","Array","isArray","possibleRecipesArrays","Object","values","filter","val","possibleRecipes","message"],"sources":["/Users/nohelestradap/Documents/VsCode/ensurancePharmacy/pharmacy/src/pages/Prescriptions.vue"],"sourcesContent":["<!-- eslint-disable vue/multi-word-component-names -->\n<template>\n  <div class=\"prescriptions-container\">\n    <!-- Hospital Selector -->\n    <HospitalSelector @hospital-selected=\"onHospitalSelected\" />\n\n    <h2 class=\"text-2xl font-bold text-center text-blue-800 mb-4\">\n      Todas las Recetas\n    </h2>\n\n    <!-- Mensaje de error si lo hay -->\n    <div v-if=\"errorMessage\" class=\"mb-4 text-red-600 text-center\">\n      {{ errorMessage }}\n    </div>\n    <!-- Lista de recetas -->\n    <div v-if=\"recipes && recipes.length > 0\" class=\"prescriptions-list\">\n      <div v-for=\"recipe in recipes\" :key=\"recipe._id\" class=\"prescription-item\">\n        <h3 class=\"text-xl font-bold\">\n          {{ getPatientName(recipe) }}\n        </h3>\n        <p v-if=\"getPatientEmail(recipe)\"><strong>Email:</strong> {{ getPatientEmail(recipe) }}</p>\n        <p><strong>ID Receta:</strong> {{ recipe._id }}</p>\n        <p><strong>Diagnóstico:</strong> {{ getDiagnostic(recipe) }}</p>\n        <p v-if=\"recipe.created_at\"><strong>Fecha:</strong> {{ recipe.created_at }}</p>\n        <p v-if=\"recipe.formatted_date\"><strong>Fecha:</strong> {{ recipe.formatted_date }}</p>\n\n        <!-- Tabla de Medicinas -->\n        <table class=\"medicine-table\" v-if=\"recipe.medicines && recipe.medicines.length > 0\">\n          <thead>\n          <tr>\n            <th>Nombre</th>\n            <th>Concentración</th>\n            <th>Presentación</th>\n            <th>Dosis</th>\n            <th>Frecuencia</th>\n            <th>Duración</th>\n            <th>Acción</th>\n          </tr>\n          </thead>\n          <tbody>\n          <tr v-for=\"medicine in recipe.medicines\" :key=\"medicine._id\">\n            <td>{{ medicine.principioActivo }}</td>\n            <td>{{ medicine.concentracion }}</td>\n            <td>{{ medicine.presentacion }}</td>\n            <td>{{ medicine.dosis }}</td>\n            <td>{{ medicine.frecuencia }}</td>\n            <td>{{ medicine.duracion }}</td>\n            <td>\n              <button \n                class=\"buy-button small\" \n                @click=\"goToVerification(medicine.principioActivo, recipe._id)\"\n              >\n                Comprar\n              </button>\n            </td>\n          </tr>\n          </tbody>\n        </table>\n        <p v-if=\"recipe.has_insurance\" class=\"insurance-info\">Con seguro médico</p>\n      </div>\n    </div>\n\n    <!-- Mensaje si no hay recetas -->\n    <div v-else class=\"text-center text-gray-600\">\n      No hay recetas disponibles.\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, onMounted, computed } from 'vue';\nimport axios from 'axios';\nimport { useRouter } from 'vue-router';\nimport HospitalSelector from '../components/HospitalSelector.vue';\n\nconst router = useRouter();\nconst recipes = ref([]);\nconst errorMessage = ref('');\nconst patientInfo = ref(null);\nconst selectedPort = ref(localStorage.getItem('selectedHospitalPort') || '');\n\n// URL base computada usando las variables de entorno\nconst baseUrl = computed(() => {\n  const serverIp = process.env.VUE_APP_IP || '192.168.0.3';\n  const port = selectedPort.value || '5050';\n  return `http://${serverIp}:${port}/recipes/email/`;\n});\n\n// Manejar la selección del hospital\nconst onHospitalSelected = (port) => {\n  selectedPort.value = port;\n  fetchPrescriptions();\n};\n\n// Funciones auxiliares para extraer información del paciente\nconst getPatientName = (recipe) => {\n  // Si el paciente es un objeto completo en la receta\n  if (recipe.patient && typeof recipe.patient === 'object' && recipe.patient.username) {\n    return recipe.patient.username;\n  }\n  // Si el paciente está referenciado como ID y tenemos la información del paciente guardada\n  if (patientInfo.value && recipe.patient === patientInfo.value._id) {\n    return patientInfo.value.username;\n  }\n  // Si doctor_details está presente, usamos el formato doctor_details\n  if (recipe.doctor_details) {\n    return recipe.patient_details ? recipe.patient_details.username : 'Paciente';\n  }\n  return 'Paciente';\n};\n\nconst getPatientEmail = (recipe) => {\n  // Si el paciente es un objeto completo en la receta\n  if (recipe.patient && typeof recipe.patient === 'object' && recipe.patient.email) {\n    return recipe.patient.email;\n  }\n  // Si el paciente está referenciado como ID y tenemos la información del paciente guardada\n  if (patientInfo.value && recipe.patient === patientInfo.value._id) {\n    return patientInfo.value.email;\n  }\n  // Si patient_details está presente\n  if (recipe.patient_details) {\n    return recipe.patient_details.email;\n  }\n  return '';\n};\n\nconst getDiagnostic = (recipe) => {\n  // Intentar obtener diagnóstico desde diferentes estructuras posibles\n  if (recipe.diagnostic) {\n    return recipe.diagnostic;\n  }\n  if (recipe.medicines && recipe.medicines.length > 0 && recipe.medicines[0].diagnostico) {\n    return recipe.medicines[0].diagnostico;\n  }\n  return 'No especificado';\n};\n\n// Función para navegar a la página de verificación\nfunction goToVerification(medicinePrincipioActivo, recipeId) {\n  if (!medicinePrincipioActivo) {\n    console.error('No se proporcionó Principio Activo para la verificación.');\n    errorMessage.value = 'Error interno: No se pudo seleccionar el medicamento.';\n    return;\n  }\n  console.log(`Navegando a VerificarCompra para Principio Activo: ${medicinePrincipioActivo}, receta ID: ${recipeId}`);\n  router.push({\n    name: 'VerificarCompra',\n    params: { id: medicinePrincipioActivo },\n    query: { recipeId: recipeId }\n  });\n}\n\nconst fetchPrescriptions = async () => {\n  // Si no hay puerto seleccionado, no continuar\n  if (!selectedPort.value) {\n    console.log('Esperando selección de hospital...');\n    return;\n  }\n\n  try {\n    // Obtener el email del usuario del localStorage\n    let userEmail = ''; // Valor por defecto\n    try {\n      const userData = JSON.parse(localStorage.getItem('user'));\n      if (userData && userData.email) {\n        userEmail = userData.email;\n        console.log(\"Email de usuario obtenido:\", userEmail);\n      } else {\n        // Intentar obtener desde session\n        const sessionData = JSON.parse(localStorage.getItem('session'));\n        if (sessionData && sessionData.email) {\n          userEmail = sessionData.email;\n          console.log(\"Email de usuario obtenido de session:\", userEmail);\n        } else {\n          console.warn(\"No se encontró el email de usuario en localStorage\");\n          // Fallback a username si no hay email\n          if (userData && userData.name) {\n            userEmail = userData.name;\n            console.log(\"Usando nombre de usuario en lugar de email:\", userEmail);\n          } else if (sessionData && sessionData.name) {\n            userEmail = sessionData.name;\n            console.log(\"Usando nombre de usuario de session en lugar de email:\", userEmail);\n          } else {\n            userEmail = 'rrrivera@unis.edu.gt'; // Valor por defecto si no hay información\n          }\n        }\n      }\n    } catch (err) {\n      console.error(\"Error al obtener el usuario del localStorage:\", err);\n      userEmail = 'rrrivera@unis.edu.gt'; // Valor por defecto en caso de error\n    }\n\n    // Usando la URL dinámica con IP y puerto\n    const url = `${baseUrl.value}${userEmail}`;\n    console.log(`Consultando recetas con URL dinámica: ${url}`);\n    \n    const response = await axios.get(url, {\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      }\n    });\n    \n    console.log(\"Respuesta recibida:\", response);\n    \n    // Verificar si la respuesta es HTML (texto que comienza con <!DOCTYPE o <html)\n    if (typeof response.data === 'string' && \n        (response.data.trim().startsWith('<!DOCTYPE') || \n         response.data.trim().startsWith('<html'))) {\n      console.error(\"Se recibió HTML en lugar de JSON:\", response.data.substring(0, 200) + '...');\n      recipes.value = [];\n      errorMessage.value = 'El servidor respondió con HTML en lugar de datos JSON. Verifique la conexión.';\n      return;\n    }\n    \n    // Manejo flexible de diferentes formatos de respuesta\n    if (response.data) {\n      let recetasEncontradas = false;\n      \n      // Verificamos si existe el objeto patient (formato nuevo)\n      if (response.data.patient && Array.isArray(response.data.recipes)) {\n        recipes.value = response.data.recipes;\n        patientInfo.value = response.data.patient;\n        recetasEncontradas = true;\n        console.log(\"Formato 1: Objeto con patient y recipes array\");\n      } \n      // Verificamos si recipes existe directamente en la respuesta como array\n      else if (Array.isArray(response.data.recipes)) {\n        recipes.value = response.data.recipes;\n        recetasEncontradas = true;\n        console.log(\"Formato 2: Objeto con recipes array\");\n      } \n      // En caso de que la API devuelva un array directamente\n      else if (Array.isArray(response.data)) {\n        recipes.value = response.data;\n        recetasEncontradas = true;\n        console.log(\"Formato 3: Array directo\");\n      } \n      // Si la API devuelve un objeto que es la receta directamente\n      else if (response.data._id && response.data.medicines) {\n        recipes.value = [response.data];\n        recetasEncontradas = true;\n        console.log(\"Formato 4: Objeto de receta única\");\n      }\n      // Si no reconocemos el formato, pero hay un objeto receta\n      else if (typeof response.data === 'object') {\n        // Intentar extraer cualquier array que parezca contener recetas\n        const possibleRecipesArrays = Object.values(response.data).filter(val => \n          Array.isArray(val) && val.length > 0 && val[0]._id && val[0].medicines\n        );\n        \n        if (possibleRecipesArrays.length > 0) {\n          recipes.value = possibleRecipesArrays[0];\n          recetasEncontradas = true;\n          console.log(\"Formato 5: Extraído array de recetas de objeto\", possibleRecipesArrays[0]);\n        } else {\n          // Último intento: buscar propiedades que parezcan recetas individuales\n          const possibleRecipes = Object.values(response.data).filter(val => \n            val && typeof val === 'object' && val._id && val.medicines\n          );\n          \n          if (possibleRecipes.length > 0) {\n            recipes.value = possibleRecipes;\n            recetasEncontradas = true;\n            console.log(\"Formato 6: Extraídas recetas individuales\", possibleRecipes);\n          }\n        }\n      }\n      \n      console.log(\"RECETAS PROCESADAS:\", recipes.value);\n      \n      if (!recetasEncontradas) {\n        console.warn(\"Formato de respuesta no reconocido:\", response.data);\n        recipes.value = [];\n        errorMessage.value = 'Formato de respuesta no reconocido. Consulte la consola para más detalles.';\n      } else if (recipes.value.length === 0) {\n        errorMessage.value = 'No se encontraron recetas para este usuario.';\n      }\n    } else {\n      console.warn(\"La respuesta del API está vacía\");\n      recipes.value = [];\n      errorMessage.value = 'No se encontraron recetas para este usuario.';\n    }\n  } catch (error) {\n    console.error(\"Error al obtener las recetas:\", error);\n    recipes.value = [];\n    errorMessage.value = `Error al obtener las recetas: ${error.message}. Por favor, inténtelo de nuevo.`;\n  }\n};\n\nonMounted(() => {\n  // Solo cargar recetas si ya hay un puerto seleccionado\n  if (selectedPort.value) {\n    fetchPrescriptions();\n  }\n});\n</script>\n\n<style scoped>\n.prescriptions-container {\n  padding: 50px;\n  background-color: #f8f9fa;\n}\n\n.prescriptions-list {\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n}\n\n.prescription-item {\n  background: white;\n  padding: 20px;\n  border-radius: 8px;\n  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\n}\n\n.medicine-table {\n  width: 100%;\n  border-collapse: collapse;\n  margin-top: 10px;\n  margin-bottom: 15px;\n}\n\n.medicine-table th, .medicine-table td {\n  border: 1px solid #ddd;\n  padding: 8px;\n  text-align: center;\n}\n\n.medicine-table th {\n  background-color: #f4f4f4;\n  font-weight: bold;\n}\n\n.insurance-info {\n  color: #4caf50;\n  font-weight: bold;\n  margin: 10px 0;\n}\n\n.buy-button {\n  background-color: #4caf50;\n  color: white;\n  padding: 8px 16px;\n  border-radius: 4px;\n  cursor: pointer;\n  border: none;\n  font-weight: bold;\n}\n\n.buy-button:hover {\n  background-color: #45a049;\n}\n\n.buy-button.small {\n  padding: 0.4rem 0.8rem;\n  font-size: 0.85rem;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}