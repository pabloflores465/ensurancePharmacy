{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport axios from 'axios';\nimport { ref, computed } from 'vue';\nimport { useUserStore } from '@/stores/userStore';\nimport ProductComments from './Comentarios.vue';\nconst userStore = useUserStore();\nexport default {\n  name: 'ProductComments',\n  // Renamed from 'Comentarios ' to 'ProductComments'\n  props: {\n    initialComments: {\n      type: Array,\n      default: () => []\n    }\n  },\n  setup(props) {\n    const comments = ref([...props.initialComments]);\n    const newCommentAuthor = ref('');\n    const newCommentText = ref('');\n    const isAdmin = computed(() => userStore.user && userStore.user.role === 'admin');\n    const filteredComments = computed(() => comments.value.filter(comment => comment.enabled !== false));\n    const addComment = () => {\n      // Use the client's name from userStore if available\n      const author = userStore.user && userStore.user.name ? userStore.user.name : newCommentAuthor.value;\n      if (author && newCommentText.value) {\n        comments.value.push({\n          id: Date.now(),\n          author: author,\n          text: newCommentText.value,\n          enabled: true // Asegurarse de que los nuevos comentarios estén habilitados\n        });\n        // Clear the input fields; if userStore data is used, clear only the text\n        if (!userStore.user || !userStore.user.name) {\n          newCommentAuthor.value = '';\n        }\n        newCommentText.value = '';\n      }\n    };\n    const deleteComment = comment => {\n      // Opcional: Enviar petición PUT a la API para actualizar el comentario\n      axios.put(`http://tu-api-url/comments/${comment.id}`, {\n        enabled: false\n      }).then(() => {\n        comment.enabled = false;\n      }).catch(error => {\n        console.error('Error al eliminar el comentario:', error);\n      });\n    };\n    return {\n      comments,\n      filteredComments,\n      newCommentAuthor,\n      newCommentText,\n      addComment,\n      isAdmin,\n      deleteComment,\n      ProductComments\n    };\n  }\n};","map":{"version":3,"names":["axios","ref","computed","useUserStore","ProductComments","userStore","name","props","initialComments","type","Array","default","setup","comments","newCommentAuthor","newCommentText","isAdmin","user","role","filteredComments","value","filter","comment","enabled","addComment","author","push","id","Date","now","text","deleteComment","put","then","catch","error","console"],"sources":["/Users/nohelestradap/Documents/VsCode/ensurancePharmacy/pharmacy/src/components/Comentarios.vue"],"sourcesContent":["<!-- eslint-disable vue/multi-word-component-names -->\n<template>\n  <div class=\"comments-container\">\n    <h3>Comentarios</h3>\n    <div v-if=\"filteredComments.length\">\n      <div v-for=\"comment in filteredComments\" :key=\"comment.id\" class=\"comment\">\n        <p><strong>{{ comment.author }}</strong>:</p>\n        <p>{{ comment.text }}</p>\n        <!-- Mostrar botón de eliminar solo para admin -->\n        <button v-if=\"isAdmin\" @click=\"deleteComment(comment)\">Eliminar</button>\n        <!-- Renderizado recursivo: si existen comentarios hijos -->\n        <ProductComments v-if=\"comment.children && comment.children.length\" :initialComments=\"comment.children\" />\n      </div>\n    </div>\n    <div v-else>\n      <p>No hay comentarios aún.</p>\n    </div>\n    <div class=\"add-comment\">\n      <input v-model=\"newCommentAuthor\" placeholder=\"Tu nombre\" />\n      <textarea v-model=\"newCommentText\" placeholder=\"Escribe un comentario...\"></textarea>\n      <button @click=\"addComment\">Agregar Comentario</button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios';\nimport { ref, computed } from 'vue';\nimport { useUserStore } from '@/stores/userStore';\nimport ProductComments from './Comentarios.vue';\n\nconst userStore = useUserStore();\n\nexport default {\n  name: 'ProductComments', // Renamed from 'Comentarios ' to 'ProductComments'\n  props: {\n    initialComments: {\n      type: Array,\n      default: () => []\n    }\n  },\n  setup(props) {\n    const comments = ref([...props.initialComments]);\n    const newCommentAuthor = ref('');\n    const newCommentText = ref('');\n\n    const isAdmin = computed(() => userStore.user && userStore.user.role === 'admin');\n\n    const filteredComments = computed(() => comments.value.filter(comment => comment.enabled !== false));\n\n    const addComment = () => {\n      // Use the client's name from userStore if available\n      const author = userStore.user && userStore.user.name ? userStore.user.name : newCommentAuthor.value;\n      if (author && newCommentText.value) {\n        comments.value.push({\n          id: Date.now(),\n          author: author,\n          text: newCommentText.value,\n          enabled: true // Asegurarse de que los nuevos comentarios estén habilitados\n        });\n        // Clear the input fields; if userStore data is used, clear only the text\n        if (!userStore.user || !userStore.user.name) {\n          newCommentAuthor.value = '';\n        }\n        newCommentText.value = '';\n      }\n    };\n\n    const deleteComment = (comment) => {\n      // Opcional: Enviar petición PUT a la API para actualizar el comentario\n      axios.put(`http://tu-api-url/comments/${comment.id}`, { enabled: false })\n        .then(() => {\n          comment.enabled = false;\n        })\n        .catch(error => {\n          console.error('Error al eliminar el comentario:', error);\n        });\n    };\n\n    return {\n      comments,\n      filteredComments,\n      newCommentAuthor,\n      newCommentText,\n      addComment,\n      isAdmin,\n      deleteComment,\n      ProductComments\n    };\n  }\n};\n</script>\n\n<style scoped>\n.comments-container {\n  margin-top: 20px;\n}\n\n.comment {\n  background: #f9f9f9;\n  padding: 10px;\n  border-radius: 5px;\n  margin-bottom: 10px;\n  margin-left: 20px;\n  border-left: 1px solid #ccc;\n  padding-left: 10px;\n}\n\n.add-comment {\n  margin-top: 20px;\n}\n\n.add-comment input,\n.add-comment textarea {\n  width: 100%;\n  padding: 10px;\n  margin-bottom: 10px;\n  border: 1px solid #ccc;\n  border-radius: 5px;\n}\n\n.add-comment button {\n  padding: 10px 15px;\n  background: #1e40af;\n  color: white;\n  border: none;\n  border-radius: 5px;\n  cursor: pointer;\n}\n\n.add-comment button:hover {\n  background: #1e3a8a;\n}\n</style>\n"],"mappings":";;;AA0BA,OAAOA,KAAI,MAAO,OAAO;AACzB,SAASC,GAAG,EAAEC,QAAO,QAAS,KAAK;AACnC,SAASC,YAAW,QAAS,oBAAoB;AACjD,OAAOC,eAAc,MAAO,mBAAmB;AAE/C,MAAMC,SAAQ,GAAIF,YAAY,CAAC,CAAC;AAEhC,eAAe;EACbG,IAAI,EAAE,iBAAiB;EAAE;EACzBC,KAAK,EAAE;IACLC,eAAe,EAAE;MACfC,IAAI,EAAEC,KAAK;MACXC,OAAO,EAAEA,CAAA,KAAM;IACjB;EACF,CAAC;EACDC,KAAKA,CAACL,KAAK,EAAE;IACX,MAAMM,QAAO,GAAIZ,GAAG,CAAC,CAAC,GAAGM,KAAK,CAACC,eAAe,CAAC,CAAC;IAChD,MAAMM,gBAAe,GAAIb,GAAG,CAAC,EAAE,CAAC;IAChC,MAAMc,cAAa,GAAId,GAAG,CAAC,EAAE,CAAC;IAE9B,MAAMe,OAAM,GAAId,QAAQ,CAAC,MAAMG,SAAS,CAACY,IAAG,IAAKZ,SAAS,CAACY,IAAI,CAACC,IAAG,KAAM,OAAO,CAAC;IAEjF,MAAMC,gBAAe,GAAIjB,QAAQ,CAAC,MAAMW,QAAQ,CAACO,KAAK,CAACC,MAAM,CAACC,OAAM,IAAKA,OAAO,CAACC,OAAM,KAAM,KAAK,CAAC,CAAC;IAEpG,MAAMC,UAAS,GAAIA,CAAA,KAAM;MACvB;MACA,MAAMC,MAAK,GAAIpB,SAAS,CAACY,IAAG,IAAKZ,SAAS,CAACY,IAAI,CAACX,IAAG,GAAID,SAAS,CAACY,IAAI,CAACX,IAAG,GAAIQ,gBAAgB,CAACM,KAAK;MACnG,IAAIK,MAAK,IAAKV,cAAc,CAACK,KAAK,EAAE;QAClCP,QAAQ,CAACO,KAAK,CAACM,IAAI,CAAC;UAClBC,EAAE,EAAEC,IAAI,CAACC,GAAG,CAAC,CAAC;UACdJ,MAAM,EAAEA,MAAM;UACdK,IAAI,EAAEf,cAAc,CAACK,KAAK;UAC1BG,OAAO,EAAE,IAAG,CAAE;QAChB,CAAC,CAAC;QACF;QACA,IAAI,CAAClB,SAAS,CAACY,IAAG,IAAK,CAACZ,SAAS,CAACY,IAAI,CAACX,IAAI,EAAE;UAC3CQ,gBAAgB,CAACM,KAAI,GAAI,EAAE;QAC7B;QACAL,cAAc,CAACK,KAAI,GAAI,EAAE;MAC3B;IACF,CAAC;IAED,MAAMW,aAAY,GAAKT,OAAO,IAAK;MACjC;MACAtB,KAAK,CAACgC,GAAG,CAAC,8BAA8BV,OAAO,CAACK,EAAE,EAAE,EAAE;QAAEJ,OAAO,EAAE;MAAM,CAAC,EACrEU,IAAI,CAAC,MAAM;QACVX,OAAO,CAACC,OAAM,GAAI,KAAK;MACzB,CAAC,EACAW,KAAK,CAACC,KAAI,IAAK;QACdC,OAAO,CAACD,KAAK,CAAC,kCAAkC,EAAEA,KAAK,CAAC;MAC1D,CAAC,CAAC;IACN,CAAC;IAED,OAAO;MACLtB,QAAQ;MACRM,gBAAgB;MAChBL,gBAAgB;MAChBC,cAAc;MACdS,UAAU;MACVR,OAAO;MACPe,aAAa;MACb3B;IACF,CAAC;EACH;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}