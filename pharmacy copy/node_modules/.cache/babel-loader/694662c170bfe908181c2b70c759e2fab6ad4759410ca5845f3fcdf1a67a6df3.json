{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport { ref, computed, onMounted } from 'vue';\nimport { useRoute } from 'vue-router';\nimport { useUserStore } from \"@/stores/userStore\";\nconst ip = process.env.VUE_APP_IP;\nconst CommentItem = {\n  name: 'CommentItem',\n  props: {\n    comment: {\n      type: Object,\n      required: true\n    },\n    allComments: {\n      type: Array,\n      required: true\n    }\n  },\n  computed: {\n    childComments() {\n      return this.allComments.filter(c => c.prevComment && c.prevComment.id === this.comment.id);\n    }\n  },\n  template: `\n    <div class=\"comment-item\">\n      <p><strong>{{ comment.user.name }}</strong>:</p>\n      <p>{{ comment.commentText }}</p>\n      <button @click=\"$emit('reply', comment)\">Responder</button>\n      <div class=\"replies\" v-if=\"childComments.length\">\n        <CommentItem\n          v-for=\"child in childComments\"\n          :key=\"child.id\"\n          :comment=\"child\"\n          :all-comments=\"allComments\"\n          @reply=\"$emit('reply', $event)\"\n        />\n      </div>\n    </div>\n  `\n};\nexport default {\n  name: 'ProductComments',\n  components: {\n    CommentItem\n  },\n  props: {\n    initialComments: {\n      type: Array,\n      default: () => []\n    }\n  },\n  setup(props) {\n    const userStore = useUserStore();\n    const route = useRoute();\n    const routeId = route.params.id;\n    const comments = ref(props.initialComments);\n    const newCommentText = ref('');\n    const replyComment = ref(null);\n    onMounted(async () => {\n      try {\n        console.log(ip);\n        const res = await fetch(`${ip}:8081/api2/comments`);\n        if (res.ok) {\n          const data = await res.json();\n          comments.value = data;\n        }\n      } catch (error) {\n        console.error('Error al obtener comentarios', error);\n      }\n    });\n    const topLevelComments = computed(() => comments.value.filter(c => !c.prevComment));\n    const addComment = async () => {\n      if (newCommentText.value) {\n        const payload = {\n          user: userStore.user,\n          prevComment: replyComment.value,\n          commentText: newCommentText.value,\n          medicine: {\n            idMedicine: routeId\n          }\n        };\n        try {\n          const res = await fetch(`${ip}:8081/api2/comments`, {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(payload)\n          });\n          if (res.ok) {\n            const newComment = await res.json();\n            comments.value.push(newComment);\n            newCommentText.value = '';\n            replyComment.value = null;\n          } else {\n            console.error('Error al crear comentario');\n          }\n        } catch (error) {\n          console.error('Error en la petición POST', error);\n        }\n      }\n    };\n    const setReply = comment => {\n      replyComment.value = comment;\n    };\n    const cancelReply = () => {\n      replyComment.value = null;\n    };\n    return {\n      comments,\n      topLevelComments,\n      newCommentText,\n      addComment,\n      replyComment,\n      setReply,\n      cancelReply\n    };\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","useRoute","useUserStore","ip","process","env","VUE_APP_IP","CommentItem","name","props","comment","type","Object","required","allComments","Array","childComments","filter","c","prevComment","id","template","components","initialComments","default","setup","userStore","route","routeId","params","comments","newCommentText","replyComment","console","log","res","fetch","ok","data","json","value","error","topLevelComments","addComment","payload","user","commentText","medicine","idMedicine","method","headers","body","JSON","stringify","newComment","push","setReply","cancelReply"],"sources":["/Users/nohelestradap/Documents/VsCode/ensurancePharmacy/pharmacy/src/components/Comentarios.vue"],"sourcesContent":["<!-- eslint-disable vue/multi-word-component-names -->\n<template>\n  <div class=\"comments-container\">\n    <h3>Comentarios</h3>\n    <div v-if=\"replyComment\" class=\"reply-info\">\n      Respondiendo a {{ replyComment.user.name }}\n      <button @click=\"cancelReply\">Cancelar Respuesta</button>\n    </div>\n    <div v-if=\"comments.length\">\n      <comment-item\n        v-for=\"comment in topLevelComments\"\n        :key=\"comment.id\"\n        :comment=\"comment\"\n        :all-comments=\"comments\"\n        @reply=\"setReply\"\n      />\n    </div>\n    <div v-else>\n      <p>No hay comentarios aún.</p>\n    </div>\n    <div class=\"add-comment\">\n      <input v-model=\"newCommentText\" placeholder=\"Escribe un comentario...\" />\n      <button @click=\"addComment\">Agregar Comentario</button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ref, computed, onMounted } from 'vue';\nimport { useRoute } from 'vue-router';\nimport { useUserStore } from \"@/stores/userStore\";\nconst ip = process.env.VUE_APP_IP;\n\nconst CommentItem = {\n  name: 'CommentItem',\n  props: {\n    comment: { type: Object, required: true },\n    allComments: { type: Array, required: true }\n  },\n  computed: {\n    childComments() {\n      return this.allComments.filter(c => c.prevComment && c.prevComment.id === this.comment.id);\n    }\n  },\n  template: `\n    <div class=\"comment-item\">\n      <p><strong>{{ comment.user.name }}</strong>:</p>\n      <p>{{ comment.commentText }}</p>\n      <button @click=\"$emit('reply', comment)\">Responder</button>\n      <div class=\"replies\" v-if=\"childComments.length\">\n        <CommentItem\n          v-for=\"child in childComments\"\n          :key=\"child.id\"\n          :comment=\"child\"\n          :all-comments=\"allComments\"\n          @reply=\"$emit('reply', $event)\"\n        />\n      </div>\n    </div>\n  `\n};\n\nexport default {\n  name: 'ProductComments',\n  components: { CommentItem },\n  props: {\n    initialComments: {\n      type: Array,\n      default: () => []\n    }\n  },\n  setup(props) {\n    const userStore = useUserStore();\n    const route = useRoute();\n    const routeId = route.params.id;\n    const comments = ref(props.initialComments);\n    const newCommentText = ref('');\n    const replyComment = ref(null);\n\n    onMounted(async () => {\n      try {\n        console.log(ip)\n        const res = await fetch(`${ip}:8081/api2/comments`);\n        if (res.ok) {\n          const data = await res.json();\n          comments.value = data;\n        }\n      } catch (error) {\n        console.error('Error al obtener comentarios', error);\n      }\n    });\n\n    const topLevelComments = computed(() => comments.value.filter(c => !c.prevComment));\n\n    const addComment = async () => {\n      if(newCommentText.value) {\n        const payload = {\n          user: userStore.user,\n          prevComment: replyComment.value,\n          commentText: newCommentText.value,\n          medicine: { idMedicine: routeId }\n        };\n        try {\n          const res = await fetch(`${ip}:8081/api2/comments`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(payload)\n          });\n          if(res.ok) {\n            const newComment = await res.json();\n            comments.value.push(newComment);\n            newCommentText.value = '';\n            replyComment.value = null;\n          } else {\n            console.error('Error al crear comentario');\n          }\n        } catch(error) {\n          console.error('Error en la petición POST', error);\n        }\n      }\n    };\n\n    const setReply = (comment) => {\n      replyComment.value = comment;\n    };\n\n    const cancelReply = () => {\n      replyComment.value = null;\n    };\n\n    return {\n      comments,\n      topLevelComments,\n      newCommentText,\n      addComment,\n      replyComment,\n      setReply,\n      cancelReply\n    };\n  }\n};\n</script>\n\n<style scoped>\n.comments-container {\n  margin-top: 20px;\n}\n\n.comment {\n  background: #f9f9f9;\n  padding: 10px;\n  border-radius: 5px;\n  margin-bottom: 10px;\n}\n\n.add-comment {\n  margin-top: 20px;\n}\n\n.add-comment input,\n.add-comment textarea {\n  width: 100%;\n  padding: 10px;\n  margin-bottom: 10px;\n  border: 1px solid #ccc;\n  border-radius: 5px;\n}\n\n.add-comment button {\n  padding: 10px 15px;\n  background: #1e40af;\n  color: white;\n  border: none;\n  border-radius: 5px;\n  cursor: pointer;\n}\n\n.add-comment button:hover {\n  background: #1e3a8a;\n}\n\n.reply-info {\n  background: #eef;\n  padding: 5px 10px;\n  border-radius: 5px;\n  margin-bottom: 10px;\n}\n\n.comment-item {\n  margin-left: 20px;\n  border-left: 1px solid #ccc;\n  padding-left: 10px;\n  margin-top: 10px;\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}