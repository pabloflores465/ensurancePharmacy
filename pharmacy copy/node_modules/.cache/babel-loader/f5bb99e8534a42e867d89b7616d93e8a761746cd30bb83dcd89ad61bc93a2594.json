{"ast":null,"code":"import { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createTextVNode as _createTextVNode, vModelText as _vModelText, withDirectives as _withDirectives, resolveComponent as _resolveComponent, createVNode as _createVNode, Fragment as _Fragment } from \"vue\";\nconst _hoisted_1 = {\n  key: 0\n};\nconst _hoisted_2 = {\n  class: \"product-container\",\n  style: {\n    \"display\": \"flex\"\n  }\n};\nconst _hoisted_3 = {\n  class: \"product-details\",\n  style: {\n    \"flex\": \"1\"\n  }\n};\nconst _hoisted_4 = [\"src\"];\nconst _hoisted_5 = {\n  class: \"purchase-section\",\n  style: {\n    \"margin-left\": \"20px\"\n  }\n};\nconst _hoisted_6 = [\"max\"];\nconst _hoisted_7 = [\"disabled\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_Comentarios = _resolveComponent(\"Comentarios\");\n  return _openBlock(), _createElementBlock(\"div\", null, [_cache[12] || (_cache[12] = _createElementVNode(\"h1\", null, \"Detalle del Producto\", -1 /* HOISTED */)), _createCommentVNode(\" Si el producto existe, mostramos su información \"), $data.product ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"h2\", null, _toDisplayString($data.product.name), 1 /* TEXT */), $data.product.images && $data.product.images.length ? (_openBlock(), _createElementBlock(\"img\", {\n    key: 0,\n    src: $data.product.images[0],\n    alt: \"Imagen principal del producto\",\n    style: {\n      \"width\": \"200px\",\n      \"border-radius\": \"8px\"\n    }\n  }, null, 8 /* PROPS */, _hoisted_4)) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"p\", null, [_cache[2] || (_cache[2] = _createElementVNode(\"strong\", null, \"Precio:\", -1 /* HOISTED */)), _createTextVNode(\" Q\" + _toDisplayString($data.product.price), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[3] || (_cache[3] = _createElementVNode(\"strong\", null, \"Descripción:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($data.product.description), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[4] || (_cache[4] = _createElementVNode(\"strong\", null, \"Inventario:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($data.product.stock) + \" unidades\", 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[5] || (_cache[5] = _createElementVNode(\"strong\", null, \"Ingrediente Activo:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($data.product.activeMedicament), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[6] || (_cache[6] = _createElementVNode(\"strong\", null, \"Descripción:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($data.product.description), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[7] || (_cache[7] = _createElementVNode(\"strong\", null, \"Concentración:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($data.product.concentration), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[8] || (_cache[8] = _createElementVNode(\"strong\", null, \"Presentación:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($data.product.presentacion), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[9] || (_cache[9] = _createElementVNode(\"strong\", null, \"Marca:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($data.product.brand), 1 /* TEXT */)])]), _createElementVNode(\"div\", _hoisted_5, [_cache[10] || (_cache[10] = _createElementVNode(\"label\", {\n    for: \"quantity\"\n  }, \"Cantidad:\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"number\",\n    id: \"quantity\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.quantity = $event),\n    min: 1,\n    max: $data.product.stock,\n    style: {\n      \"width\": \"60px\",\n      \"margin-left\": \"10px\"\n    }\n  }, null, 8 /* PROPS */, _hoisted_6), [[_vModelText, $data.quantity, void 0, {\n    number: true\n  }]]), _createElementVNode(\"button\", {\n    onClick: _cache[1] || (_cache[1] = (...args) => $options.purchaseProduct && $options.purchaseProduct(...args)),\n    disabled: !$data.quantity || $data.quantity < 1 || $data.quantity > $data.product.stock,\n    style: {\n      \"margin-left\": \"10px\"\n    }\n  }, \" Comprar \", 8 /* PROPS */, _hoisted_7)])]), _createVNode(_component_Comentarios, {\n    initialComments: $data.productComments\n  }, null, 8 /* PROPS */, [\"initialComments\"])])) : (_openBlock(), _createElementBlock(_Fragment, {\n    key: 1\n  }, [_createCommentVNode(\" Si no existe el producto, mostramos un mensaje de error \"), _cache[11] || (_cache[11] = _createElementVNode(\"div\", null, [_createElementVNode(\"p\", null, \"Producto no encontrado.\")], -1 /* HOISTED */))], 2112 /* STABLE_FRAGMENT, DEV_ROOT_FRAGMENT */))]);\n}","map":{"version":3,"names":["key","class","style","_createElementBlock","_createElementVNode","_createCommentVNode","$data","product","_hoisted_1","_hoisted_2","_hoisted_3","_toDisplayString","name","images","length","src","alt","_hoisted_4","_createTextVNode","price","description","stock","activeMedicament","concentration","presentacion","brand","_hoisted_5","for","type","id","_cache","$event","quantity","min","max","_hoisted_6","number","onClick","args","$options","purchaseProduct","disabled","_hoisted_7","_createVNode","_component_Comentarios","initialComments","productComments","_Fragment"],"sources":["/Users/nohelestradap/Documents/VsCode/ensurancePharmacy/pharmacy/src/pages/ProductoDetalle.vue"],"sourcesContent":["<!-- eslint-disable vue/multi-word-component-names -->\n<template>\n    <div>\n      <h1>Detalle del Producto</h1>\n\n      <!-- Si el producto existe, mostramos su información -->\n      <div v-if=\"product\">\n        <div class=\"product-container\" style=\"display: flex;\">\n          <div class=\"product-details\" style=\"flex: 1;\">\n            <h2>{{ product.name }}</h2>\n            <img\n              v-if=\"product.images && product.images.length\"\n              :src=\"product.images[0]\"\n              alt=\"Imagen principal del producto\"\n              style=\"width: 200px; border-radius: 8px;\"\n            />\n            <p><strong>Precio:</strong> Q{{ product.price }}</p>\n            <p><strong>Descripción:</strong> {{ product.description }}</p>\n            <p><strong>Inventario:</strong> {{ product.stock }} unidades</p>\n            <p><strong>Ingrediente Activo:</strong> {{ product.activeMedicament }}</p>\n            <p><strong>Descripción:</strong> {{ product.description }}</p>\n            <p><strong>Concentración:</strong> {{ product.concentration }}</p>\n            <p><strong>Presentación:</strong> {{ product.presentacion }}</p>\n            <p><strong>Marca:</strong> {{ product.brand }}</p>\n          </div>\n          <div class=\"purchase-section\" style=\"margin-left: 20px;\">\n            <label for=\"quantity\">Cantidad:</label>\n            <input\n              type=\"number\"\n              id=\"quantity\"\n              v-model.number=\"quantity\"\n              :min=\"1\"\n              :max=\"product.stock\"\n              style=\"width: 60px; margin-left: 10px;\"\n            />\n            <button\n              @click=\"purchaseProduct\"\n              :disabled=\"!quantity || quantity < 1 || quantity > product.stock\"\n              style=\"margin-left: 10px;\"\n            >\n              Comprar\n            </button>\n          </div>\n        </div>\n        <Comentarios :initialComments=\"productComments\" />\n      </div>\n      <!-- Si no existe el producto, mostramos un mensaje de error -->\n      <div v-else>\n        <p>Producto no encontrado.</p>\n      </div>\n    </div>\n  </template>\n\n  <script>\n  import Comentarios from '@/components/Comentarios.vue';\n  import axios from \"axios\";\n  import { useUserStore } from '@/stores/userStore';\n\n\n  const ip = process.env.VUE_APP_IP;\n\n  export default {\n    name: \"ProductoDetalle\",\n    components: {\n      Comentarios\n    },\n    // Se recibe el id del producto vía props (asegúrate de que el router lo pase correctamente)\n    props: [\"id\"],\n    data() {\n      return {\n        product: null,\n        quantity: 1,\n        productComments: [\n          { idComments: 1, user: { name: 'Juan' }, commentText: '¡Muy buen producto!' },\n          { idComments: 2, user: { name: 'Maria' }, commentText: 'Me ayudó mucho, gracias!' }\n        ]\n      };\n    },\n    mounted() {\n      const routeId = this.$route.params.id;\n      axios.get(`http://${ip}:8081/api2/medicines`)\n          .then(response => {\n //           console.log(\"Usuario: \",user)\n            const products = response.data;\n            console.log(this.$route.params.id);\n            this.product = products.find(prod => prod.idMedicine === Number(routeId));\n          })\n          .catch(error => {\n            console.error('Error fetching medicines:', error);\n          });\n    },\n    methods: {\n      purchaseProduct() {\n        const userStore = useUserStore();\n        const userId = userStore.user.idUser;\n\n        // Obtener todas las órdenes para el usuario\n        axios.get(`http://${ip}:8081/api2/orders?userId=${userId}`)\n          .then(response => {\n            const orders = response.data;\n            // Filtrar la orden que esté en progreso\n            const orderInProgress = orders.find(order => order.status === 'En progreso');\n            if (orderInProgress) {\n              return orderInProgress;\n            } else {\n              // No hay orden en progreso, crear una nueva\n              return axios.post(`http://${ip}:8081/api2/orders`, {\n                user: { idUser: userId },\n                status: 'En progreso'\n              }).then(response => response.data);\n            }\n          })\n          .then(order => {\n            // Agregar la medicina a order_medicines\n            return axios.post(`http://${ip}:8081/api2/order_medicines`, {\n              orders: order,\n              medicine: { idMedicine: this.product.idMedicine },\n              quantity: this.quantity,\n              cost: this.product.price,\n              total: this.product.price * this.quantity\n            });\n          })\n          .then(response => {\n            console.log('Orden y medicamento añadidos:', response.data);\n          })\n          .catch(error => {\n            console.error('Error al agregar medicamento a la orden:', error);\n          });\n      }\n    }\n  };\n  </script>\n\n  <style scoped>\n  /* Estilos opcionales */\n  </style>"],"mappings":";;EAAAA,GAAA;AAAA;;EAOaC,KAAK,EAAC,mBAAmB;EAACC,KAAsB,EAAtB;IAAA;EAAA;;;EACxBD,KAAK,EAAC,iBAAiB;EAACC,KAAgB,EAAhB;IAAA;EAAA;;mBARvC;;EAyBeD,KAAK,EAAC,kBAAkB;EAACC,KAA0B,EAA1B;IAAA;EAAA;;mBAzBxC;mBAAA;;;uBAEIC,mBAAA,CAgDM,c,4BA/CJC,mBAAA,CAA6B,YAAzB,sBAAoB,sBAExBC,mBAAA,qDAAwD,EAC7CC,KAAA,CAAAC,OAAO,I,cAAlBJ,mBAAA,CAuCM,OA7CZK,UAAA,GAOQJ,mBAAA,CAoCM,OApCNK,UAoCM,GAnCJL,mBAAA,CAgBM,OAhBNM,UAgBM,GAfJN,mBAAA,CAA2B,YAAAO,gBAAA,CAApBL,KAAA,CAAAC,OAAO,CAACK,IAAI,kBAEXN,KAAA,CAAAC,OAAO,CAACM,MAAM,IAAIP,KAAA,CAAAC,OAAO,CAACM,MAAM,CAACC,MAAM,I,cAD/CX,mBAAA,CAKE;IAfdH,GAAA;IAYee,GAAG,EAAET,KAAA,CAAAC,OAAO,CAACM,MAAM;IACpBG,GAAG,EAAC,+BAA+B;IACnCd,KAAyC,EAAzC;MAAA;MAAA;IAAA;0BAdde,UAAA,KAAAZ,mBAAA,gBAgBYD,mBAAA,CAAoD,Y,0BAAjDA,mBAAA,CAAwB,gBAAhB,SAAO,sBAhB9Bc,gBAAA,CAgBuC,IAAE,GAAAP,gBAAA,CAAGL,KAAA,CAAAC,OAAO,CAACY,KAAK,iB,GAC7Cf,mBAAA,CAA8D,Y,0BAA3DA,mBAAA,CAA6B,gBAArB,cAAY,sBAjBnCc,gBAAA,CAiB4C,GAAC,GAAAP,gBAAA,CAAGL,KAAA,CAAAC,OAAO,CAACa,WAAW,iB,GACvDhB,mBAAA,CAAgE,Y,0BAA7DA,mBAAA,CAA4B,gBAApB,aAAW,sBAlBlCc,gBAAA,CAkB2C,GAAC,GAAAP,gBAAA,CAAGL,KAAA,CAAAC,OAAO,CAACc,KAAK,IAAG,WAAS,gB,GAC5DjB,mBAAA,CAA0E,Y,0BAAvEA,mBAAA,CAAoC,gBAA5B,qBAAmB,sBAnB1Cc,gBAAA,CAmBmD,GAAC,GAAAP,gBAAA,CAAGL,KAAA,CAAAC,OAAO,CAACe,gBAAgB,iB,GACnElB,mBAAA,CAA8D,Y,0BAA3DA,mBAAA,CAA6B,gBAArB,cAAY,sBApBnCc,gBAAA,CAoB4C,GAAC,GAAAP,gBAAA,CAAGL,KAAA,CAAAC,OAAO,CAACa,WAAW,iB,GACvDhB,mBAAA,CAAkE,Y,0BAA/DA,mBAAA,CAA+B,gBAAvB,gBAAc,sBArBrCc,gBAAA,CAqB8C,GAAC,GAAAP,gBAAA,CAAGL,KAAA,CAAAC,OAAO,CAACgB,aAAa,iB,GAC3DnB,mBAAA,CAAgE,Y,0BAA7DA,mBAAA,CAA8B,gBAAtB,eAAa,sBAtBpCc,gBAAA,CAsB6C,GAAC,GAAAP,gBAAA,CAAGL,KAAA,CAAAC,OAAO,CAACiB,YAAY,iB,GACzDpB,mBAAA,CAAkD,Y,0BAA/CA,mBAAA,CAAuB,gBAAf,QAAM,sBAvB7Bc,gBAAA,CAuBsC,GAAC,GAAAP,gBAAA,CAAGL,KAAA,CAAAC,OAAO,CAACkB,KAAK,iB,KAE7CrB,mBAAA,CAiBM,OAjBNsB,UAiBM,G,4BAhBJtB,mBAAA,CAAuC;IAAhCuB,GAAG,EAAC;EAAU,GAAC,WAAS,sB,gBAC/BvB,mBAAA,CAOE;IANAwB,IAAI,EAAC,QAAQ;IACbC,EAAE,EAAC,UAAU;IA7B3B,uBAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IA8B8BzB,KAAA,CAAA0B,QAAQ,GAAAD,MAAA;IACvBE,GAAG,EAAE,CAAC;IACNC,GAAG,EAAE5B,KAAA,CAAAC,OAAO,CAACc,KAAK;IACnBnB,KAAuC,EAAvC;MAAA;MAAA;IAAA;0BAjCdiC,UAAA,I,cA8B8B7B,KAAA,CAAA0B,QAAQ,E;IAAhBI,MAAM,EAAd;EAAyB,E,IAK3BhC,mBAAA,CAMS;IALNiC,OAAK,EAAAP,MAAA,QAAAA,MAAA,UAAAQ,IAAA,KAAEC,QAAA,CAAAC,eAAA,IAAAD,QAAA,CAAAC,eAAA,IAAAF,IAAA,CAAe;IACtBG,QAAQ,GAAGnC,KAAA,CAAA0B,QAAQ,IAAI1B,KAAA,CAAA0B,QAAQ,QAAQ1B,KAAA,CAAA0B,QAAQ,GAAG1B,KAAA,CAAAC,OAAO,CAACc,KAAK;IAChEnB,KAA0B,EAA1B;MAAA;IAAA;KACD,WAED,iBAzCZwC,UAAA,E,KA4CQC,YAAA,CAAkDC,sBAAA;IAApCC,eAAe,EAAEvC,KAAA,CAAAwC;EAAe,6C,oBAGhD3C,mBAAA,CAEM4C,SAAA;IAjDZ/C,GAAA;EAAA,IA8CMK,mBAAA,6DAAgE,E,4BAChED,mBAAA,CAEM,cADJA,mBAAA,CAA8B,WAA3B,yBAAuB,E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}